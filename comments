Вопросы

было все относительно понятно пока не появилось в задание т-1 -7

1) Сформированный инкремент содержит три файла:
customer_research_inc.csv,
user_order_log_inc.csv,
user_activity_log_inc.csv.

мы используем customer_research_inc.csv, остальные не нужны?

2) как оптимизировать запрос? он много тратит времени на get_report (его нельзя сделать один раз на 
неделю)?

3) приложил скриншот - Dag при перезапуске не пересчитывает все сначала, а добавляет пустые "выполненые"
дни

4) попробовал решит 3 задание , но не получилось. Посоветуй как можно решить

  # Удаление старых данных из таблицы f_customer_retention
    clear_f_customer_retention = PostgresOperator(
       task_id='clear_f_customer_retention',
        postgres_conn_id=postgres_conn_id,
        sql="""
          DELETE FROM mart.f_customer_retention 
          WHERE retention_date = '{{ params.date }}'
          AND (
             -- Условие проверки неполных данных
                (SELECT COUNT(*) FROM mart.f_customer_retention WHERE retention_date = '{{ params.date }}') = 0
                OR 
                (SELECT COUNT(*) FROM staging.user_order_log WHERE retention_date = '{{ params.date }}') > 0
                );
            """,
          params={"date": business_dt}
    )

    clear_f_sales = PostgresOperator(
        task_id='clear_f_sales',
        postgres_conn_id=postgres_conn_id,
        sql="""
           DELETE FROM mart.f_sales 
           WHERE sales_date = '{{ params.date }}'
           AND (
               -- Условие проверки неполных данных
               (SELECT COUNT(*) FROM mart.f_sales WHERE sales_date = '{{ params.date }}') = 0
              OR 
               (SELECT COUNT(*) FROM staging.user_order_log WHERE sales_date = '{{ params.date }}') > 0
           );
        """,
        params={"date": business_dt}
    )    